# コンピューティング：AWSソリューションアーキテクトアソシエイト

## [Amazon Elastic Compute Cloud (EC2)](https://aws.amazon.com/jp/ec2/)

ハイパーバイザー仮想化を利用したコンピューティングサービス

### インスタンスメタデータ（EC2）

実行中のEC2インスタンスを設定するのに用いる  

#### EC2インスタンスメタデータで確認できる情報

* プライベートIPアドレス
* パブリックIPアドレス
* インスタンスのローカルホスト名
* 公開鍵（パブリックキー）

※起動時間は確認できない  

## インスタンスの種類

|No|種類|内容|
|--:|:---|:---|
|1|スポット|AWS側で余裕があるときに、ユーザーから提示した料金より安い場合に利用できる<br>中断されることがあるので、アプリケーションはEC2に障害が発生しても適切に対処できる必要がある|
|2|リザーブド|予約することで最大75%の割引を受ける<br>いつでもは使えない|
|3|オンデマンド|利用した分だけ課金|

### [リザーブドインスタンス](https://aws.amazon.com/jp/ec2/pricing/reserved-instances/)

利用期間分をあらかじめ購入することで割引価格が適応

|種類|内容|
|:---|:---|
|Standardタイプ|リージョンやAZを指定してインスタンスを購入、同じインスタンス構成なら同じリージョンやAZ内でインスタンスの配置変更が可能|
|Convertibleタイプ|自由に構成変更が可能だが、Standardタイプより割高|
|スケジュール|1年間に渡り毎日・毎週・毎月キャパシー予約を受けつける|

### EC2インスタンスストア

インスタンス用のブロックレベルの一時ストレージを提供  
暗号化には対応していない  
（EBS, Glacier, DynamoDB, Storge Gateway, SQSは暗号化に対応）

### [Elastic IP](https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html)

Amazon Elastic Compute Cloud用語  
アタッチしているEC2インスタンスが起動しているなら無料  

### ネットワークACLとセキュリティグループ

|種類|内容|
|:---|:---|
|ネットワークACL|VPC内のファイアウォール、サブネット間を跨ぐ通信を制御<br>特定のIPアドレスからの通信を拒否する設定はできない<br>許可しなければデフォルトで拒否|
|セキュリティグループ|EC2などに用いる、ファイアウォールで外部アクセスに対応|

### EC2におけるssh接続用標準ユーザー

ec2-user

### EC2のEIPアドレス

利用していない期間も課金される

### EC2に割り当てるアドレス

|項目|コメント|
|:---|:---|
|パブリックアドレス<br>パブリックサブネット|**EC2を起動するたびに毎回ランダムで割り当てられる<br>EC2インスタンスに割り当てないとEC2インスタンスはインターネットへアクセス不可**|
|プライベートアドレス<br>プライベートサブネット|再起動してもアドレスは固定<br>EC2インスタンスを削除しない限り保持される<br>**EC2インスタンスをサブネットで起動したら割り当てられる**<br>管理用SSHに使用、自社からSSH管理をするための接続はVPNを用いる|
|**ENI** (Erastic Network Interface)|セカンダリなプライベートIPアドレスとして利用できる<br>他のEC2インスタンスに割り当て可能|

### EC2インスタンスへのIAMロールの追加や修正方法

EC2マネジメントコンソールからEC2インスタンスのアクション操作でアタッチする

## プレイスメントグループ

単一AZ内のEC2インスタンスを論理的にグルーピングしたもの  

## [AWS Auto Scaling](https://aws.amazon.com/jp/autoscaling/)

EC2インスタンス増加時は、EC2インスタンスが一番少ないAZを指定して起動する  
Auto Scalingでコスト効率がよく可用性高い設定にするには、Desired Capacityをインスタンスで最適なパフォーマンスを発揮する数で指定し、1つのアベイラビリティゾーンがダウンしても最小限必要なインスタンス数を維持するよう設定する  

### ユーザーデータ（EC2）

EC2起動時に一度だけスクリプトを実行できる  
Auto Scalingグループで作成された新しいAmazon Linuxインスタンスにカスタムスクリプトを渡すこともできる  

### Auto Scalingグループ

起動されたインスタンスは複数のアベイラビリティーゾーン間で均等にバランシングされる  

## [API Gateway](https://aws.amazon.com/jp/api-gateway/)

APIを簡単に作れる  
APIキャッシュを有効にすることでレスポンスがキャッシュされ、APIキャッシュは時間単位で課金される  
有効期限TTLが0の場合、キャッシュはされない  

## [Amazon ElastiCache](https://aws.amazon.com/jp/elasticache/)

メモリ上でキャッシュするので高速  
RDSと組み合わせる  

ElastiCacheの種類は以下の通り  
※どちらも複数台用いた大規模化が可能  

|種類|Redis用|memcached用|
|:---|:---|:---|
|概要|Redis(Remote dictionary Server)とはメモリ上にKey-Valueストアを構築することができるDBサーバーの1つ|分散メモリキャッシュシステムの1つ<br>DBの読み出し結果を返す|
|向いているケース|データ型:複雑<br>暗号化:あり<br>マルチスレッド:なし<br>高可用性:あり<br>自動フェイルオーバー:必須<br>バックアップと復元:あり|**データ型:シンプル**<br>暗号化:なし<br>**マルチスレッド:あり**<br>高可用性:なし<br>自動フェイルオーバー:なし<br>バックアップと復元:なし|

### Redis用ElastiCache

Redis(Remote dictionary Server)とはメモリ上にKey-Valueストアを構築することができるDBサーバーの1つ、複数台用いた大規模化が可能  
以下の環境に適する  

## Elastic

弾力性のある  
